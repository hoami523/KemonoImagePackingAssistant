# Kemono图片打包助手

## 使用教程

### 一、如何在Chrome中安装未打包的插件

1. **下载插件源码**
   - 将本项目文件夹（如 `Kemono图片打包助手`）下载或解压到本地任意目录。

2. **打开Chrome扩展管理页面**
   - 在Chrome浏览器地址栏输入 `chrome://extensions/` 并回车。

3. **开启开发者模式**
   - 在扩展页面右上角，打开"开发者模式"开关。

4. **加载已解压的扩展程序**
   - 点击左上角"加载已解压的扩展程序"按钮。
   - 在弹出的文件选择窗口中，选择你刚才下载/解压的插件文件夹（如 `Kemono图片打包助手`），点击"选择"。

5. **安装成功**
   - 安装成功后，插件会出现在扩展列表中，并自动启用。
   - 建议将插件图标固定到浏览器工具栏，方便后续使用。

### 二、如何使用本插件下载图片

1. **访问目标页面**
   - 打开 `https://kemono.su/*/user/*` 下的任意作品页面。

2. **查找浮动图标**
   - 页面右上角会出现一个紫色的圆形浮动图标。
   - 可用鼠标或手指拖动图标到任意位置。

3. **展开菜单**
   - 点击浮动图标，弹出"打包下载图片"按钮。

4. **一键打包下载**
   - 点击"打包下载图片"按钮，插件会自动抓取页面所有大图并打包为zip文件。
   - 下载过程中会显示进度条和详细调试信息。

5. **保存文件**
   - 下载完成后，浏览器会自动弹出保存zip文件的对话框，或直接保存到"下载"文件夹。
   - 解压zip文件，即可获得所有图片，且已按001、002、003...顺序命名。

6. **遇到问题怎么办？**
   - 可刷新页面重试，或参考文档末尾的"常见问题（QA）"部分。

一个专为kemono.su网站设计的Chrome扩展，可以自动获取页面中的所有图片并打包下载。

## 功能特点

- 🖼️ **自动识别图片**：智能识别kemono.su页面中的图片内容
- 📦 **一键打包**：将所有图片打包成ZIP文件下载
- 🎯 **精准过滤**：自动过滤头像、图标等无关图片
- 📱 **移动端适配**：完美支持PC端和移动端使用
- 🎨 **美观界面**：现代化的浮动图标和菜单设计
- 🖱️ **自由拖拽**：浮动图标可以自由拖动到任意位置

## 使用方法

1. **安装扩展**
   - 下载扩展文件
   - 在Chrome浏览器中打开 `chrome://extensions/`
   - 开启"开发者模式"
   - 点击"加载已解压的扩展程序"，选择扩展文件夹

2. **使用扩展**
   - 访问任意kemono.su用户页面（如：`https://kemono.su/fanbox/user/xxx`）
   - 页面右上角会出现一个紫色的浮动图标
   - 点击图标展开菜单
   - 点击"打包下载图片"按钮开始下载
   - 等待进度条完成，ZIP文件会自动下载到本地

3. **移动端使用**
   - 在移动端浏览器中同样可以使用
   - 支持触摸拖拽功能
   - 界面会自动适配移动端尺寸

## 技术特性

- **智能图片识别**：自动识别`.post__files`容器中的图片链接
- **文件类型过滤**：只下载图片文件（JPG、PNG、GIF、WebP、BMP、SVG）
- **文件大小过滤**：自动过滤小于50KB的小文件，避免下载缩略图
- **序号重命名**：下载的文件按001、002、003...格式重命名
- **多格式支持**：支持JPG、PNG、GIF、WebP、BMP、SVG等多种图片格式
- **进度显示**：实时显示下载进度和状态
- **错误处理**：完善的错误处理机制，网络异常时会有提示
- **性能优化**：添加下载间隔，避免请求过快被限制

## 文件结构

```
Kemono图片打包助手/
├── manifest.json          # 扩展配置文件
├── content.js             # 主要功能脚本
├── content.css            # 样式文件
├── popup.html             # 弹出窗口HTML
├── popup.js               # 弹出窗口脚本
├── popup.css              # 弹出窗口样式
├── lib/
│   └── jszip.js          # JSZip库文件
├── icons/                 # 扩展图标
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   └── icon128.png
└── README.md             # 说明文档
```

## 注意事项

- 扩展仅在kemono.su用户页面（`kemono.su/*/user/*`）启用
- 需要网络连接来下载图片
- 某些图片可能因为跨域限制无法下载
- 建议在图片较多的页面使用效果更佳

## 更新日志

### v1.0.0
- 初始版本发布
- 支持图片自动识别和打包下载
- 支持PC端和移动端
- 支持浮动图标拖拽
- 适配kemono.su网站结构

## 许可证

MIT License 

## 常见问题（QA）

### Q1：插件下载图片并打包为zip的过程是怎样的？
**A：** 插件会遍历页面上的所有目标图片链接，使用fetch下载图片数据（Blob），这些数据只存在于浏览器内存中。下载完所有图片后，使用JSZip库在内存中打包成zip文件，然后通过浏览器的下载功能保存到本地。整个过程不会在硬盘上生成任何临时文件。

### Q2：图片下载过程中，临时文件会存放在哪里？
**A：** 所有图片和zip文件都只存在于浏览器的内存（RAM）中，不会写入硬盘临时文件。

### Q3：如果下载过程中卡住或出错，临时文件会不会一直占用我的硬盘空间？
**A：** 不会。即使卡住或出错，所有数据都只在内存中，关闭页面或刷新后，内存会被释放，不会残留在硬盘。只有您手动下载的zip文件会保存在硬盘（通常在"下载"文件夹）。

### Q4：内存会不会被一直占用？
**A：** 只要页面还在处理，内存会被占用（尤其图片很多时会占用较多内存）。一旦页面关闭、刷新，或下载完成后释放临时链接，内存会被浏览器自动回收。

### Q5：如果下载过程中断，怎么办？
**A：** 只会影响本次操作，不会留下任何临时文件。可以刷新页面重新操作。

### Q6：如果我下载了一次，然后换到其他的作品页面再下载，内存会一直累加吗？
**A：** 不会。每次切换页面或刷新，浏览器会自动销毁原页面的所有内存数据，内存会被正常释放，不会累加。只有当前页面正在下载时会占用内存。 